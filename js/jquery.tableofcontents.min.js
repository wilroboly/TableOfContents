/*
	TableOfContents Plugin for jQuery (by Doug Neiner)
	
	Modified by William Roboly

	Version: 0.8.1

	Based on code and concept by Janko Jovanovic 
	  in his article: http://www.jankoatwarpspeed.com/post/2009/08/20/Table-of-contents-using-jQuery.aspx
	
	This plugin is offered under the MIT license.
	(c) 2009 by Doug Neiner, http://dougneiner.com
*/
!function(t){t.TableOfContents=function(e,n,i){var o=this;return o.$el=t(e),o.el=e,o.toc="",o.listStyle=null,o.tags=["h1","h2","h3","h4","h5","h6"],o.init=function(){o.options=t.extend({},t.TableOfContents.defaultOptions,i),("undefined"==typeof n||null==n)&&(n=document.body),o.$scope=t(n);var e=o.$scope.find(o.tags.join(", ")).filter(":first");if(1==e.length){o.starting_depth=o.options.startLevel,o.options.depth<1&&(o.options.depth=1);var s=o.tags.splice(o.options.startLevel-1,o.options.depth);if(o.$headings=o.$scope.find(s.join(", ")).filter(":not("+o.options.ignoreTagsClass+")"),o.options.topLinks!==!1){var l=t(document.body).attr("id");""==l&&(l=o.options.topBodyId,document.body.id=l),o.topLinkId=l}return o.$el.is("ul")?o.listStyle="ul":o.$el.is("ol")&&(o.listStyle="ol"),o.buildTOC(),o.options.proportionateSpacing!==!0||o.tieredList()||o.addSpacing(),o}},o.tieredList=function(){return"ul"==o.listStyle||"ol"==o.listStyle},o.buildTOC=function(){o.current_depth=o.starting_depth,o.$headings.each(function(t,e){var n=this.nodeName.toLowerCase().substr(1,1);(t>0||0==t&&n!=o.current_depth)&&o.changeDepth(n),o.toc+=o.formatLink(this,n,t)+"\n",o.options.topLinks!==!1&&o.addTopLink(this)}),o.changeDepth(o.starting_depth,!0),o.tieredList()&&(o.toc="<li>\n"+o.toc+"</li>\n"),o.$el.html(o.toc)},o.addTopLink=function(e){var n=o.options.topLinks===!0?"Top":o.options.topLinks,i=t("<a href='#"+o.topLinkId+"' class='"+o.options.topLinkClass+"'></a>").html(n);t(e).append(i)},o.formatLink=function(e,n,i){var s=e.id;""==s&&(s=o.buildSlug(t(e).text()),e.id=s);var l="<a href='#"+s+"'";return o.tieredList()||(l+=" class='"+o.depthClass(n)+"'"),l+=">"+o.options.levelText.replace("%",t(e).text())+"</a>"},o.changeDepth=function(t,e){if(o.options.tocNavClass,e!==!0&&(e=!1),!o.tieredList())return o.current_depth=t,!0;if(t>o.current_depth){for(var n=[],i=o.current_depth;t>i;i++){var s="";o.options.tocNavClass.length>0&&(s=' class="'+o.options.tocNavClass+'"'),n.push("<"+o.listStyle+s+">\n")}var l="<li>\n";o.toc+=n.join(l)+l}else if(t<o.current_depth){for(var a=[],i=o.current_depth;i>t;i--)a.push("</"+o.listStyle+">\n");o.toc+="</li>\n"+a.join("</li>\n"),e||(o.toc+="</li>\n<li>\n")}else e||(o.toc+="</li>\n<li>\n");o.current_depth=t},o.buildSlug=function(t){return t=t.toLowerCase().replace(/[^a-z0-9 -]/gi,"").replace(/ /gi,"-"),t=t.substr(0,50)},o.depthClass=function(t){return o.options.levelClass.replace("%",t-(o.starting_depth-1))},o.addSpacing=function(){var e=o.$headings.filter(":first").position().top;o.$headings.each(function(n,i){var s=o.$el.find("a:eq("+n+")"),l=(t(this).position().top-e)/(o.$scope.height()-e)*o.$el.height();s.css({position:"absolute",top:l})})},o.init()},t.TableOfContents.defaultOptions={startLevel:1,depth:3,levelClass:"toc-depth-%",levelText:"%",topLinks:!1,topLinkClass:"toc-top-link",topBodyId:"toc-top",proportionateSpacing:!1,tocNavClass:"",ignoreTagsClass:""},t.fn.tableOfContents=function(e,n){return this.each(function(){var i=new t.TableOfContents(this,e,n);delete i})}}(jQuery);